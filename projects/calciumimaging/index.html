<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>        
    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Neural Circuits and Algorithms | Calcium Imaging</title>
    <meta name="author" content="  " />
    <meta name="description" content="Calcium imaging data analysis" />
    <meta name="keywords" content="dmitri chklovskii, mitya chklovskii, connectomics, neural circuits, neural algorithms, computational neuroscience, flatiron institute" />


    <!-- Bootstrap & MDB -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

    <!-- Styles -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ§ </text></svg>">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://neural-circuits-and-algorithms.github.io/projects/calciumimaging/">
  </head>

  <!-- Body -->
  <body class="fixed-top-nav">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
        <!-- <a class="navbar-link" href="https://www.simonsfoundation.org/flatiron/">
          <img class="navbar-logo" src="/assets/img/fi-logo.png"/>
        </a>
        <a class="navbar-link" href="https://www.simonsfoundation.org/flatiron/center-for-computational-neuroscience/">
          <img class="navbar-logo" src="/assets/img/brain-logo.png"/>
        </a> -->
        <a class="navbar-brand title font-weight-lighter" href="https://neural-circuits-and-algorithms.github.io/">
            CHKLOVSKII LAB
        </a>


          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About
              <li class="nav-item ">
                <a class="nav-link" href="/">About</a>
              </li> -->
              
              <!-- Blog -->
              <li class="nav-item ">
                <a class="nav-link" href="/blog/">Blog</a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/careers/" target="_blank">Careers</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/people/">People</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">Publications</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">Calcium Imaging</h1>
            <p class="post-description">Calcium imaging data analysis</p>
          </header>

          <article>
            <p>Calcium imaging is an increasingly popular experimental method that enables monitoring of large, targeted, neural populations in alive and behaving animals. This microscopy method offers an indirect signal that needs to be preprocessed for the extraction of the actual neural population activity. Recent advances in calcium imaging acquisition techniques are creating datasets of the order of Terabytes/week. Memory and computationally efficient algorithms are required to analyze in reasonable amount of time terabytes of data. This project implements a set of essential methods required in the calcium imaging movies analysis pipeline. Fast and scalable algorithms are implemented for motion correction, movie manipulation, and source and spike extraction. CaImAn also provides tools for one-photon calcium imaging, voltage imaging, and online processing.</p>

<p>Our software package can be found <a href="https://github.com/flatironinstitute/CaImAn" target="_blank" rel="noopener noreferrer">here</a></p>

<p>Videos</p>
<ul>
  <li><a href="https://www.youtube.com/watch?v=5APzPRbzUIA" target="_blank" rel="noopener noreferrer">CaImAn by Andrea Giovannucci</a></li>
</ul>

          </article>

        </div>
<div class="publications">
          <h3>Related Publications</h3>
          <div> 
          <ol class="bibliography">
<li>
<!-- _layouts/bib.html -->
      <div class="row">
<div class="photo">
            <img class="photo-image" src="/assets/img/pubs/volpy.png">        
          </div>
<!-- Entry bib key -->
        <div id="cai2021volpy" class="col-sm-8">
        
          <!-- Title --><a class="title" style="color:black;" href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008806" target="_blank" rel="noopener noreferrer">VolPy: Automated and scalable analysis pipelines for voltage imaging datasets</a><!-- Author -->
          <div class="author">Cai C,Â Friedrich J,Â Singh A,Â Eybposh M,Â Pnevmatikakis E,Â Podgorski K,Â and Giovannucci A
          </div>

          <!-- Journal/Book title and date -->
          <div class="periodical">
            <em>PLoS Computational Biology</em> 2021
          </div>
        
        <!-- <div class="col-sm-2 abbr"></div> -->

          <!-- Links/Buttons -->
          <div class="links">
            <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a>
            <a href="https://journals.plos.org/ploscompbiol/article/file?id=10.1371/journal.pcbi.1008806&amp;type=printable" class="btn btn-sm z-depth-0" role="button" target="_blank" rel="noopener noreferrer">PDF</a>
            <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008806" class="btn btn-sm z-depth-0" role="button" target="_blank" rel="noopener noreferrer">URL</a>
          </div>

          <!-- Hidden abstract block -->
          <div class="abstract hidden">
            <p>Voltage imaging enables monitoring neural activity at sub-millisecond and sub-cellular scale, unlocking the study of subthreshold activity, synchrony, and network dynamics with unprecedented spatio-temporal resolution. However, high data rates (&gt;800MB/s) and low signal-to-noise ratios create bottlenecks for analyzing such datasets. Here we present VolPy, an automated and scalable pipeline to pre-process voltage imaging datasets. VolPy features motion correction, memory mapping, automated segmentation, denoising and spike extraction, all built on a highly parallelizable, modular, and extensible framework optimized for memory and speed. To aid automated segmentation, we introduce a corpus of 24 manually annotated datasets from different preparations, brain areas and voltage indicators. We benchmark VolPy against ground truth segmentation, simulations and electrophysiology recordings, and we compare its performance with existing algorithms in detecting spikes. Our results indicate that VolPyâ€™s performance in spike extraction and scalability are state-of-the-art.</p>
          </div>
        </div>
      </div>
</li>
<li>
<!-- _layouts/bib.html -->
      <div class="row">
<div class="photo">
            <img class="photo-image" src="/assets/img/pubs/friedrich2021online.png">        
          </div>
<!-- Entry bib key -->
        <div id="friedrich2021online" class="col-sm-8">
        
          <!-- Title --><a class="title" style="color:black;" href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008565" target="_blank" rel="noopener noreferrer">Online analysis of microendoscopic 1-photon calcium imaging data streams</a><!-- Author -->
          <div class="author">Friedrich J,Â Giovannucci A,Â and Pnevmatikakis E
          </div>

          <!-- Journal/Book title and date -->
          <div class="periodical">
            <em>PLoS Computational Biology</em> 2021
          </div>
        
        <!-- <div class="col-sm-2 abbr"></div> -->

          <!-- Links/Buttons -->
          <div class="links">
            <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a>
            <a href="https://journals.plos.org/ploscompbiol/article/file?id=10.1371/journal.pcbi.1008565&amp;type=printable" class="btn btn-sm z-depth-0" role="button" target="_blank" rel="noopener noreferrer">PDF</a>
            <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008565" class="btn btn-sm z-depth-0" role="button" target="_blank" rel="noopener noreferrer">URL</a>
          </div>

          <!-- Hidden abstract block -->
          <div class="abstract hidden">
            <p>In vivo calcium imaging through microendoscopic lenses enables imaging of neuronal populations deep within the brains of freely moving animals. Previously, a constrained matrix factorization approach (CNMF-E) has been suggested to extract single-neuronal activity from microendoscopic data. However, this approach relies on offline batch processing of the entire video data and is demanding both in terms of computing and memory requirements. These drawbacks prevent its applicability to the analysis of large datasets and closed-loop experimental settings. Here we address both issues by introducing two different online algorithms for extracting neuronal activity from streaming microendoscopic data. Our first algorithm, \on, presents an online adaptation of the CNMF-E algorithm, which dramatically reduces its memory and computation requirements. Our second algorithm proposes a convolution-based background model for microendoscopic data that enables even faster (real time) processing. Our approach is modular and can be combined with existing online motion artifact correction and activity deconvolution methods to provide a highly scalable pipeline for microendoscopic data analysis. We apply our algorithms on four previously published typical experimental datasets and show that they yield similar high-quality results as the popular offline approach, but outperform it with regard to computing time and memory requirements. They can be used instead of CNMF-E to process pre-recorded data with boosted speeds and dramatically reduced memory requirements. Further, they newly enable online analysis of live-streaming data even on a laptop.</p>
          </div>
        </div>
      </div>
</li>
<li>
<!-- _layouts/bib.html -->
      <div class="row">
<div class="photo">
            <img class="photo-image" src="/assets/img/pubs/caiman.jpg">        
          </div>
<!-- Entry bib key -->
        <div id="giovannucci2019caiman" class="col-sm-8">
        
          <!-- Title --><a class="title" style="color:black;" href="https://elifesciences.org/articles/38173" target="_blank" rel="noopener noreferrer">CaImAn: An open source tool for scalable Calcium Imaging data Analysis</a><!-- Author -->
          <div class="author">Giovannucci A,Â Friedrich J,Â Gunn P,Â Kalfon J,Â Brown B,Â Koay S,Â Taxidis J,Â Najafi F,Â Gauthier J,Â Zhou P,Â Khakh B,Â Tank D,Â <a href="https://www.simonsfoundation.org/people/dmitri-mitya-chklovskii/" target="_blank" rel="noopener noreferrer">Chklovskii D</a>,Â and Pnevmatikakis E
          </div>

          <!-- Journal/Book title and date -->
          <div class="periodical">
            <em>eLife</em> 2019
          </div>
        
        <!-- <div class="col-sm-2 abbr"></div> -->

          <!-- Links/Buttons -->
          <div class="links">
            <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a>
            <a href="https://github.com/flatironinstitute/CaImAn" class="btn btn-sm z-depth-0" role="button" target="_blank" rel="noopener noreferrer">Code</a>
            <a href="https://elifesciences.org/articles/38173" class="btn btn-sm z-depth-0" role="button" target="_blank" rel="noopener noreferrer">URL</a>
          </div>

          <!-- Hidden abstract block -->
          <div class="abstract hidden">
            <p>Advances in fluorescence microscopy enable monitoring larger brain areas in-vivo with finer time resolution. The resulting data rates require reproducible analysis pipelines that are reliable, fully automated, and scalable to datasets generated over the course of months. We present CaImAn, an open-source library for calcium imaging data analysis. CaImAn provides automatic and scalable methods to address problems common to pre-processing, including motion correction, neural activity identification, and registration across different sessions of data collection. It does this while requiring minimal user intervention, with good scalability on computers ranging from laptops to high-performance computing clusters. CaImAn is suitable for two-photon and one-photon imaging, and also enables real-time analysis on streaming data. To benchmark the performance of CaImAn we collected and combined a corpus of manual annotations from multiple labelers on nine mouse two-photon datasets. We demonstrate that CaImAn achieves near-human performance in detecting locations of active neurons.</p>
          </div>
        </div>
      </div>
</li>
<li>
<!-- _layouts/bib.html -->
      <div class="row">
<div class="photo">
            <img class="photo-image" src="/assets/img/pubs/OnACID.png">        
          </div>
<!-- Entry bib key -->
        <div id="giovannucci2017OnACID" class="col-sm-8">
        
          <!-- Title --><a class="title" style="color:black;" href="https://papers.nips.cc/paper/2017/hash/4edaa105d5f53590338791951e38c3ad-Abstract.html" target="_blank" rel="noopener noreferrer">OnACID: Online Analysis of Calcium Imaging Data in Real Time</a><!-- Author -->
          <div class="author">Giovannucci A,Â Friedrich J,Â Kaufman M,Â Churchland A,Â <a href="https://www.simonsfoundation.org/people/dmitri-mitya-chklovskii/" target="_blank" rel="noopener noreferrer">Chklovskii D</a>,Â Paninski L,Â and Pnevmatikakis E
          </div>

          <!-- Journal/Book title and date -->
          <div class="periodical">
            <em>In Advances in Neural Information Processing Systems</em> 2017
          </div>
        
        <!-- <div class="col-sm-2 abbr"></div> -->

          <!-- Links/Buttons -->
          <div class="links">
            <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a>
            <a href="https://proceedings.neurips.cc/paper/2017/file/4edaa105d5f53590338791951e38c3ad-Paper.pdf" class="btn btn-sm z-depth-0" role="button" target="_blank" rel="noopener noreferrer">PDF</a>
            <a href="https://papers.nips.cc/paper/2017/hash/4edaa105d5f53590338791951e38c3ad-Abstract.html" class="btn btn-sm z-depth-0" role="button" target="_blank" rel="noopener noreferrer">URL</a>
          </div>

          <!-- Hidden abstract block -->
          <div class="abstract hidden">
            <p>Optical imaging methods using calcium indicators are critical for monitoring the activity of large neuronal populations in vivo. Imaging experiments typically generate a large amount of data that needs to be processed to extract the activity of the imaged neuronal sources. While deriving such processing algorithms is an active area of research, most existing methods require the processing of large amounts of data at a time, rendering them vulnerable to the volume of the recorded data, and preventing real-time experimental interrogation. Here we introduce OnACID, an Online framework for the Analysis of streaming Calcium Imaging Data, including i) motion artifact correction, ii) neuronal source extraction, and iii) activity denoising and deconvolution. Our approach combines and extends previous work on online dictionary learning and calcium imaging data analysis, to deliver an automated pipeline that can discover and track the activity of hundreds of cells in real time, thereby enabling new types of closed-loop experiments. We apply our algorithm on two large scale experimental datasets, benchmark its performance on manually annotated data, and show that it outperforms a popular offline approach.</p>
          </div>
        </div>
      </div>
</li>
<li>
<!-- _layouts/bib.html -->
      <div class="row">
<div class="photo">
            <img class="photo-image" src="/assets/img/pubs/NoRMCorre.jpg">        
          </div>
<!-- Entry bib key -->
        <div id="pnevmatikakis2017normcorre" class="col-sm-8">
        
          <!-- Title --><a class="title" style="color:black;" href="https://www.sciencedirect.com/science/article/pii/S0165027017302753" target="_blank" rel="noopener noreferrer">NoRMCorre: An online algorithm for piecewise rigid motion correction of calcium imaging data</a><!-- Author -->
          <div class="author">Pnevmatikakis E,Â and Giovannucci A
          </div>

          <!-- Journal/Book title and date -->
          <div class="periodical">
            <em>Journal of Neuroscience Methods</em> 2017
          </div>
        
        <!-- <div class="col-sm-2 abbr"></div> -->

          <!-- Links/Buttons -->
          <div class="links">
            <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a>
            <a href="https://reader.elsevier.com/reader/sd/pii/S0165027017302753?token=608390C16B5A2B7F7164DCCB91D865D32809CC12C6837E582BD51BBB3203B21B967B24C5E913A62B21F81FB6712D5AFE&amp;originRegion=us-east-1&amp;originCreation=20220707192104" class="btn btn-sm z-depth-0" role="button" target="_blank" rel="noopener noreferrer">PDF</a>
            <a href="https://github.com/flatironinstitute/NoRMCorre" class="btn btn-sm z-depth-0" role="button" target="_blank" rel="noopener noreferrer">Code</a>
            <a href="https://www.sciencedirect.com/science/article/pii/S0165027017302753" class="btn btn-sm z-depth-0" role="button" target="_blank" rel="noopener noreferrer">URL</a>
          </div>

          <!-- Hidden abstract block -->
          <div class="abstract hidden">
            <p>Background: 
Motion correction is a challenging pre-processing problem that arises early in the analysis pipeline of calcium imaging data sequences. The motion artifacts in two-photon microscopy recordings can be non-rigid, arising from the finite time of raster scanning and non-uniform deformations of the brain medium.
New method: 
We introduce an algorithm for fast Non-Rigid Motion Correction (NoRMCorre) based on template matching. NoRMCorre operates by splitting the field of view (FOV) into overlapping spatial patches along all directions. The patches are registered at a sub-pixel resolution for rigid translation against a regularly updated template. The estimated alignments are subsequently up-sampled to create a smooth motion field for each frame that can efficiently approximate non-rigid artifacts in a piecewise-rigid manner.
Existing methods: 
Existing approaches either do not scale well in terms of computational performance or are targeted to non-rigid artifacts arising just from the finite speed of raster scanning, and thus cannot correct for non-rigid motion observable in datasets from a large FOV.
Results: 
NoRMCorre can be run in an online mode resulting in comparable to or even faster than real time motion registration of streaming data. We evaluate its performance with simple yet intuitive metrics and compare against other non-rigid registration methods on simulated data and in vivo two-photon calcium imaging datasets. Open source Matlab and Python code is also made available.
Conclusions: 
The proposed method and accompanying code can be useful for solving large scale image registration problems in calcium imaging, especially in the presence of non-rigid deformations.</p>
          </div>
        </div>
      </div>
</li>
</ol>
          </div>
        </div>
    </div>

    <!-- Footer -->    <!-- 
    <footer class="fixed-bottom">
      <div class="container mt-0">
        &copy; Copyright 2025   . 
      </div>
    </footer> -->
  </body>

  <!-- jQuery -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  <!-- Mansory & imagesLoaded -->
  <script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
  <script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/mansory.js" type="text/javascript"></script>
  
  <!-- Enable Tooltips -->
  <script type="text/javascript">
  $(function () {$('[data-toggle="tooltip"]').tooltip()})
  </script>
  <!-- Medium Zoom JS -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script src="/assets/js/common.js"></script>

  <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

  
</html>

